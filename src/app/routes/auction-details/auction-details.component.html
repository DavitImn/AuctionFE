<!-- Normal view -->
<div class="auction-details-container" [class.hidden]="isFullscreen">
  <div class="breadcrumb">
    <a href="/home">მთავარი</a> → <a href="/pages">გვერდები</a> → <span>ავტომობილები</span>
  </div>

  <div class="main-content">
    <div class="image-section">
      <div class="main-image-container">
        <div class="image-wrapper" 
             [class.zoomed]="zoomLevel > 1"
             [style.cursor]="zoomLevel > 1 ? 'zoom-in' : 'default'"
             (mousemove)="onMouseMove($event)">
          <img 
            #mainImage
            [src]="selectedImageUrl" 
            alt="{{data?.item?.title}}" 
            class="main-image"
            [style.transform]="zoomLevel > 1 ? 'scale(' + zoomLevel + ') translate(' + (50 - mouseX) + '%, ' + (50 - mouseY) + '%)' : 'none'"
          />
        </div>
        
        <div class="image-controls" [class.hidden]="!data?.item?.imageUrls?.length">
          <button class="nav-btn prev" (click)="previousImage()" *ngIf="data?.item?.imageUrls?.length > 1">
            <i class="fas fa-chevron-left"></i>
          </button>
          <button class="nav-btn next" (click)="nextImage()" *ngIf="data?.item?.imageUrls?.length > 1">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>

        <div class="zoom-controls">
          <button class="zoom-btn" (click)="adjustZoom(true)" [disabled]="zoomLevel >= 3">
            <i class="fas fa-search-plus"></i>
          </button>
          <button class="zoom-btn" (click)="adjustZoom(false)" [disabled]="zoomLevel <= 1">
            <i class="fas fa-search-minus"></i>
          </button>
          <button class="fullscreen-btn" (click)="toggleFullscreen()">
            <i class="fas" [class.fa-expand]="!isFullscreen" [class.fa-compress]="isFullscreen"></i>
          </button>
        </div>
      </div>

      <div class="thumbnail-row">
        <img
          *ngFor="let img of data?.item?.imageUrls; let i = index"
          [src]="_http.publicUrl + img"
          [class.active]="currentImageIndex === i"
          (click)="selectImage(i)"
          alt="thumbnail"
          class="thumbnail"
        />
      </div>

      <div class="location-user-view" [class.hidden]="isFullscreen">
        <div class="location">
          <i class="fas fa-map-marker-alt"></i> თბილისი
        </div>
        <div class="seller">
          <i class="fas fa-user"></i> {{data?.item?.seller?.firstName}}<br />
          {{data?.item?.seller?.email}}
        </div>
      </div>
    </div>

    <div class="details-section" [class.hidden]="isFullscreen">
      <div class="header-section">
        <div class="title-wrapper">
          <h2>{{data.item.title}}</h2>
          <div class="title-border"></div>
        </div>
        <button class="favorite-btn" (click)="toggleFavorite()" [class.active]="isFavorite">
          <i class="fas fa-heart"></i>
        </button>
      </div>

      <div class="price-section">
        <div class="current-price">
          <span class="label">მიმდინარე ფასი</span>
          <span class="amount">{{data.currentPrice}}₾</span>
        </div>
        <div class="price-details">
          <div class="detail-row">
            <span>საკომისიო</span>
            <span>10.00%</span>
          </div>
          <div class="detail-row">
            <span>მინიმალური ბიჯი</span>
            <span>{{data.minimumBidIncrement}}₾</span>
          </div>
        </div>
      </div>

      <div class="auction-info">
        <div class="info-row date-info">
          <strong>დაწყება:</strong> 
          <span>{{data.startTime | date:'yyyy-MM-dd HH:mm'}}</span>
        </div>
        <div class="info-row date-info">
          <strong>დასრულება:</strong> 
          <span>{{data.endTime | date:'yyyy-MM-dd HH:mm'}}</span>
        </div>
        <div class="info-row bid-info">
          <strong>დადებული ბიდები:</strong> 
          <span>{{data.bidCount}}</span>
        </div>
      </div>

      <div class="countdown-section">
        <div class="countdown-label">აუქციონის დასრულებამდე დარჩენილია:</div>
        <div class="countdown-display">
          <div class="time-unit">
            <span class="count">{{days}}</span>
            <span class="label">დღე</span>
          </div>
          <div class="time-unit">
            <span class="count">{{hours}}</span>
            <span class="label">სთ</span>
          </div>
          <div class="time-unit">
            <span class="count">{{minutes}}</span>
            <span class="label">წთ</span>
          </div>
          <div class="time-unit">
            <span class="count">{{seconds}}</span>
            <span class="label">წმ</span>
          </div>
        </div>
      </div>

      <div class="bid-section">
        <div class="bid-input-group">
          <input type="number" class="bid-input" placeholder="შეიყვანეთ თანხა" />
          <button class="btn-bid">
            <i class="fas fa-gavel"></i> ბიდის დადება
          </button>
        </div>
        <div class="bid-actions">
          <button class="buy-now-btn">
            <i class="fas fa-shopping-cart"></i> ახლავე ყიდვა
          </button>
          <button class="add-watchlist-btn">
            <i class="fas fa-star"></i> სიაში დამატება
          </button>
        </div>
      </div>

      <div class="auction-metrics">
        <div class="metric">
          <span class="value">{{data.bidCount}}</span>
          <span class="label">აქტიური ბიდები</span>
        </div>
        <div class="metric">
          <span class="value">{{viewCount}}</span>
          <span class="label">ნახვები</span>
        </div>
        <div class="metric">
          <span class="value">{{data.totalBids || 0}}</span>
          <span class="label">ჯამური ბიდები</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Fullscreen overlay -->
<div *ngIf="isFullscreen" class="fullscreen-mode">
  <div class="fullscreen-image-container">
    <div class="image-wrapper">
      <img 
        #mainImage
        [src]="selectedImageUrl" 
        alt="{{data?.item?.title}}" 
        class="main-image"
      />
    </div>
    
    <div class="image-controls" [class.hidden]="!data?.item?.imageUrls?.length">
      <button class="nav-btn prev" (click)="previousImage()" *ngIf="data?.item?.imageUrls?.length > 1">
        <i class="fas fa-chevron-left"></i>
      </button>
      <button class="nav-btn next" (click)="nextImage()" *ngIf="data?.item?.imageUrls?.length > 1">
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>

    <div class="zoom-controls">
      <button class="fullscreen-btn" (click)="toggleFullscreen()">
        <i class="fas fa-compress"></i>
      </button>
    </div>
  </div>
</div>

<!-- Add the image modal component -->
<app-image-modal
  *ngIf="selectedImage"
  [imageUrl]="selectedImage"
  [altText]="auctionDetails?.item?.title"
  (close)="closeImageModal()"
></app-image-modal>
